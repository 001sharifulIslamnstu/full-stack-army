# Lecture 40 - State Lifting and Filtering Techniques

## Introduction

আজকে আমাদের প্রথম কাজ হচ্ছে স্টেট লিফটিং। এর জন্য আমরা একটা ছোট অ্যাপ্লিকেশন বেছে নিয়েছি। যেটার নাম কনটাক্ট লিস্ট। কারণ এই অ্যাপ্লিকেশনকে অনেকভাবে এক্সপান্ড করা যায়। আমরা প্রথমে আমাদের প্রজেক্ট vite এর মাধ্যমে scaffold করে নিবো। এরপর আমাদের কাজ শুরু।

## Contact App

### Plannning

আমরা কি করতে চাইছি তা আগে বুঝতে হবে। তার জন্য আমরা একটা ডায়াগ্রাম বানিয়ে নিই।

![lecture-40.jpg](https://cdn.hashnode.com/res/hashnode/image/upload/v1662710047301/k93dQrmyI.jpg)

আমরা একটা সিম্পল অ্যাপ বানাবো। প্রথমে একটা ফর্ম থাকবে যেখানে আমরা ইনপুট দিবো। এরপর কনটাক্ট লিস্টটা একটা টেবিল আকারে আউটপুট দিবে। তাহলে অ্যাপ ছাড়া আমাদের কম্পোনেন্ট দুইটা - একটা ফর্ম কম্পোনেন্ট এবং আরেকটা টেবিল কম্পোনেন্ট। আমাদের সমস্ত ডাটা থাকবে অ্যাপ কম্পোনেন্টে। কিন্তু ফর্ম ম্যানেজ করতে হলে ফর্ম কম্পোনেন্টে কিছু লোকাল স্টেটের দরকার হবে, যা শুধুমাত্র এই কম্পোনেন্টের মধ্যে থাকবে অন্য কোথাও থাকবে না। অর্থাৎ অ্যাপ কম্পোনেন্টের মধ্যে থাকবে না। তাহলে ফর্মে যে লোকাল স্টেটটা থাকবে সেটাকে লিফট করে আমাদের অ্যাপের কাছে পাঠাতে হবে। আমরা জানি স্টেট ফ্লো সবসময় উপর থেকে নিচে হয় অর্থাৎ প্যারেন্ট থেকে চাইল্ডের দিকে। নিচ থেকে উপরে না। এখন যদি কোনো কারণে কোনো কম্পোনেন্টের মধ্যে লোকাল স্টেট থাকে তা হলো সেই কম্পোনেন্টের নিজস্ব ডাটা। ঐ কম্পোনেন্টের বাইরে এই স্টেটের কোনো অ্যাক্সেস থাকবে না। এখন যদি কোনো সময় এই স্টেটকে আমাদের প্যারেন্টের কাছে পাঠাতে হয় সেক্ষেত্রে আমরা ব্যবহার করবো স্টেট লিফটিং।

এখন স্টেট লিফট করে আমরা কি করবো? আমরা চাইল্ড থেকে প্যারেন্টের মধ্যে লোকাল স্টেটগুলোকে দিয়ে সেগুলোকে কোনো না কোনো স্টেটের মধ্যে রাখবো। ধরি আমাদের অ্যাপ কম্পোনেন্টের মধ্যে সমস্ত কন্টাক্ট অ্যারে আকারে রাখছি। আর ফর্মের লোকাল স্টেটের মধ্যে আমরা শুধু একটা কনটাক্ট ক্রিয়েট করতে পারছি। অর্থাৎ আমরা একটা অবজেক্ট ক্রিয়েট করতে পারছি। তার মানে লোকাল স্টেটের মধ্যে আছে অবজেক্ট। এখন এই অবজেক্টকে আমাদের প্যারেন্ট বা যেখান থেকে ডাটা ডিস্ট্রিবিউট হচ্ছে সেখানে পৌঁছিয়ে দিতে চাইছি। এবং সেখানে যে অ্যারে রয়েছে তার মধ্যে রাখতে চাইছি। তার মানে অ্যাপ বা প্যারেন্টে একটা স্টেট থাকবে।

আমরা অ্যাপ স্টেটের মধ্যে একটা হ্যান্ডলার ফাংশন নিবো যেটা অ্যাপ স্টেটকে আপডেট করতে পারে। এই ফাংশনকে প্রপ্স আকারে ফর্ম কম্পোনেন্টের কাছে পাস করে দিবো। এই কম্পোনেন্ট সেই হ্যান্ডলার ফাংশনকে কল করবে লোকাল স্টেট দিয়ে। যখন ফর্ম কম্পোনেন্ট লোকাল স্টেট দিয়ে অ্যাপ কম্পোনেন্টের কাছে থাকা ফাংশনকে কল করছে, তখন এটা আপাতদৃষ্টিতে ফর্ম কম্পোনেন্টের মধ্যে এক্সিকিউট হচ্ছে বলে মনে হলেও সেটা আসলে হবে অ্যাপ কম্পোনেন্টের মধ্যে। যেহেতু অ্যাপ কম্পোনেন্টের মধ্যে এক্সিকিউট হচ্ছে তাই ঐ ফাংশন লোকাল স্টেট দিয়ে অ্যাপ স্টেটকে আপডেট করে দিতে পারবে। কারণ অ্যাপ স্টেটের অ্যাক্সেস এই ফাংশনের মধ্যে আছে যেহেতু অ্যাপ থেকে এক্সিকিউট হচ্ছে। আবার যেহেতু ফর্ম থেকে কল হচ্ছে তাই এর লোকাল স্টেটের এক্সেসও এই ফাংশনের কাছে রয়েছে। এখানে তিনটা কনসেপ্ট কাজ করছে।

- কোথায় ফাংশনটা তৈরি হচ্ছে সেই স্কোপ
- কোথায় ফাংশনটা কল হচ্ছে সেই স্কোপ
- কল হওয়ার সময় কোন কনটেক্সট কাজ করছে সেটা

এই তিনটা কনসেপ্ট মিলিয়েই মূলত হচ্ছে স্টেট লিফটিং। বুঝতে যতটা জটিল মনে হচ্ছে এটা কিন্তু ততটা জটিল না। প্র্যাকটিক্যালি দেখলে বুঝা যাবে সহজেই।

### ContactForm Component

আমরা প্রথমে `App.jsx` এর মধ্যে ContactForm কম্পোনেন্ট বানিয়ে নিই।

```jsx
const ContactForm = () => {
	return (
		<form>
			<div>
				<label htmlFor="name">Name:</label>
				<input type="text" id="name" name="name" />
			</div>
			<div>
				<label htmlFor="email">Email:</label>
				<input type="email" id="email" name="email" />
			</div>
			<input type="button" value="Create New Contact" />
		</form>
	);
};

const App = () => {
	return (
		<div>
			<h1>Contact App</h1>
			<ContactForm />
		</div>
	);
};

export default App;
```

এবার আমরা যদি আমাদের অ্যাপ্লিকেশন চালু করি দেখবো আমাদের ব্রাউজারে ফর্মটা দেখা যাচ্ছে। এখন এই ফর্মটা আনকন্ট্রোলড অবস্থায় আছে। একে কন্ট্রোলড করার জন্য এই কম্পোনেন্টের ভিতরেই আমরা স্টেট নিবো।

```jsx
import { useState } from 'react';

const CONTACT_FORM_INIT_STATE = {
	name: '',
	email: '',
};

const ContactForm = () => {
	const [values, setValues] = useState({ ...CONTACT_FORM_INIT_STATE });
	const { name, email } = values;

	return (
		<form>
			<div>
				<label htmlFor="name">Name:</label>
				<input type="text" id="name" name="name" value={name} />
			</div>
			<div>
				<label htmlFor="email">Email:</label>
				<input type="email" id="email" name="email" value={email} />
			</div>
			<input type="button" value="Create New Contact" />
		</form>
	);
};

const App = () => {
	return <div>// ...</div>;
};

export default App;
```
